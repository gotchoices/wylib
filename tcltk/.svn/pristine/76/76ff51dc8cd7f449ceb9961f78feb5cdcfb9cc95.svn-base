LIBDIR=/ati/etc/tcl
DEFS=
OBJS=
LBITS := $(shell getconf LONG_BIT)

all:	libwylib.so libwylib-x86_64.so

libwylib-x86_64.so: checkline-x86_64.o checkpwd-x86_64.o misc-x86_64.o rpn-x86_64.o wylib-x86_64.o
ifeq ($(LBITS),64)
	gcc -m64 -shared checkline-x86_64.o checkpwd-x86_64.o misc-x86_64.o rpn-x86_64.o wylib-x86_64.o -o libwylib-x86_64.so -lpam -lcrypt
endif

libwylib.so: checkline.o checkpwd.o misc.o rpn.o wylib.o
	gcc -m32 -shared checkline.o checkpwd.o misc.o rpn.o wylib.o -o libwylib.so -lpam -lcrypt

wylib-x86_64.o: wylib.c ../Version.h
ifeq ($(LBITS),64)
	gcc -m64 -fpic -c wylib.c -o wylib-x86_64.o ${DEFS}
endif

wylib.o: wylib.c ../Version.h
	gcc -m32 -fpic -c wylib.c ${DEFS}

misc-x86_64.o: misc.c ../Version.h
ifeq ($(LBITS),64)
	gcc -m64 -fpic -c misc.c -o misc-x86_64.o ${DEFS}
endif

misc.o: misc.c ../Version.h
	gcc -m32 -fpic -c misc.c ${DEFS}

rpn-x86_64.o: rpn.c ../Version.h
ifeq ($(LBITS),64)
	gcc -m64 -fpic -c rpn.c -o rpn-x86_64.o ${DEFS}
endif

rpn.o: rpn.c ../Version.h
	gcc -m32 -fpic -c rpn.c ${DEFS}

checkline-x86_64.o: checkline.c
ifeq ($(LBITS),64)
	gcc -m64 -fpic -c checkline.c -o checkline-x86_64.o ${DEFS}
endif

checkline.o: checkline.c
	gcc -m32 -fpic -c checkline.c ${DEFS}

checkpwd-x86_64.o: checkpwd.c
ifeq ($(LBITS),64)
	gcc -m64 -fpic -c checkpwd.c -o checkpwd-x86_64.o ${DEFS}
endif

checkpwd.o: checkpwd.c
	gcc -m32 -fpic -c checkpwd.c ${DEFS}

clean:
	rm -f *.so *.o
